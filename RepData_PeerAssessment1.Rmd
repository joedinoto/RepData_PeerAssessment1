---
title: "RepData_PeerAssessment1"
author: "joedinoto"
date: "7/6/2019"
output: 
  html_document: 
    keep_md: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Loading and preprocessing the data

Load the data into a dataframe.
```{r }
unzip("activity.zip")
DF<- read.csv("activity.csv")
```
Use `tidyverse` and `lubridate` to make the date column read as dates, the interval column as factors, and turn the whole dataframe into a tibble.
```{r}
library(tidyverse)
library(lubridate)
DF$date <- ymd(DF$date)
DF$interval <- as.factor(DF$interval)
DF<- as_tibble(DF)
```


## What is mean total number of steps taken per day?

For this part of the assignment, you can ignore the missing values in the dataset.

 1. Make a histogram of the total number of steps taken each day
 
First, figure out the total number of steps taken each day using `dplyr`. 
```{r}
newDF <- na.omit(DF)
by_date<- newDF %>%   
  group_by(date,add=TRUE) %>%
  summarise(total_steps=sum(steps))
by_date
```

Now create the histogram.
```{r}
with(by_date,hist(total_steps, breaks=10))
```

 2. Calculate and report the mean and median total number of steps taken per day

This table, for no good reason, gives the mean of each day over every 5 minute interval. But that's not what we're looking for. 
```{r}
by_date_mean <- newDF %>%
  group_by(date) %>%
  summarise(mean_steps=mean(steps))
by_date_mean
```

What we're looking for is the mean and median total number of steps taken when we add up the total number of steps per day, not including NAs but including zeros. Those figures are below. 
```{r}
mean(by_date$total_steps)
```

```{r}
median(by_date$total_steps)
```

## What is the average daily activity pattern?

 1. Make a time series plot (i.e. `type = "l"`) of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all days (y-axis)


```{r}
by_interval_mean <-newDF %>%
  group_by(interval) %>%
  summarize(mean_steps =mean(steps))
by_interval_mean
```

```{r}
with(by_interval_mean,plot(interval,mean_steps,type="l",ylab="mean number of steps",xlab="5-minute interval"))
```

 2. Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?
 
```{r}
by_interval_mean[which.max(by_interval_mean$mean_steps),]
```
